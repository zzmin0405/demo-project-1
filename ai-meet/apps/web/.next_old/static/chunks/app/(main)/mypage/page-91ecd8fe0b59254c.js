(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[537],{879:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var s=t(284),a=t(7722),l=t(6297),i=t(5232),n=t(8716),d=t(7493),o=t(3327),c=t(1651),u=t(8601),m=t(3634),f=t(2029),x=t(7017),p=t(2952),h=t(1634);function g(){var e;let{data:r,status:t,update:g}=(0,a.useSession)(),v=(0,l.useRouter)(),[j,N]=(0,i.useState)(""),[y,b]=(0,i.useState)(""),[w,k]=(0,i.useState)(!1),[C,R]=(0,i.useState)([]),[E,P]=(0,i.useState)(!0);(0,i.useEffect)(()=>{"unauthenticated"===t&&v.push("/login"),(null==r?void 0:r.user)&&(N(r.user.name||""),b(r.user.image||""),B(),setTimeout(()=>{B()},1e3))},[r,t,v]);let B=async()=>{try{let e=await fetch("/api/meeting/my?t=".concat(Date.now()),{cache:"no-store",headers:{Pragma:"no-cache","Cache-Control":"no-cache"}});if(e.ok){let r=await e.json();R(r.meetings)}}catch(e){console.error("Failed to fetch meetings",e)}finally{P(!1)}},_=async e=>{if(confirm("정말로 이 회의방을 삭제하시겠습니까?"))try{(await fetch("/api/meeting/".concat(e),{method:"DELETE"})).ok?R(r=>r.filter(r=>r.id!==e)):alert("회의방 삭제에 실패했습니다.")}catch(e){console.error("Failed to delete meeting",e),alert("오류가 발생했습니다.")}},T=async()=>{k(!0);try{(await fetch("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:j,image:y})})).ok?(await g({name:j,image:y}),alert("프로필이 저장되었습니다.")):alert("저장에 실패했습니다.")}catch(e){console.error("Error saving profile:",e),alert("오류가 발생했습니다.")}finally{k(!1)}};return"loading"===t?(0,s.jsx)("div",{className:"flex justify-center items-center h-screen",children:"Loading..."}):(0,s.jsxs)("div",{className:"container mx-auto p-4 max-w-4xl space-y-8",children:[(0,s.jsxs)(o.Zp,{children:[(0,s.jsxs)(o.aR,{children:[(0,s.jsx)(o.ZB,{children:"프로필 설정"}),(0,s.jsx)(o.BT,{children:"내 정보를 확인하고 수정할 수 있습니다."})]}),(0,s.jsx)(o.Wu,{className:"space-y-6",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-8 items-start",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-4 w-full md:w-auto",children:[(0,s.jsx)("div",{className:"relative w-32 h-32",children:y?(0,s.jsx)(n.default,{src:y,alt:"Profile",fill:!0,className:"rounded-full object-cover border-4 border-primary/20"}):(0,s.jsx)("div",{className:"w-32 h-32 rounded-full bg-secondary flex items-center justify-center text-5xl font-bold text-muted-foreground",children:(null==j?void 0:j[0])||"?"})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"font-medium text-muted-foreground",children:null==r||null==(e=r.user)?void 0:e.email})})]}),(0,s.jsxs)("div",{className:"flex-1 space-y-4 w-full",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.J,{htmlFor:"name",children:"이름 (닉네임)"}),(0,s.jsx)(c.p,{id:"name",value:j,onChange:e=>N(e.target.value),placeholder:"이름을 입력하세요"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.J,{htmlFor:"image",children:"프로필 이미지 URL"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(c.p,{id:"image",value:y,onChange:e=>b(e.target.value),placeholder:"https://example.com/image.jpg",className:"flex-1"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"file",id:"file-upload",className:"hidden",accept:"image/jpeg, image/png",onChange:async e=>{var r;let t=null==(r=e.target.files)?void 0:r[0];if(!t)return;if(t.size>3145728)return void alert("파일 크기는 3MB 이하여야 합니다.");if(!["image/jpeg","image/png"].includes(t.type))return void alert("JPEG 또는 PNG 파일만 가능합니다.");let s=new FormData;s.append("file",t);try{k(!0);let e=await fetch("/api/upload",{method:"POST",body:s});if(!e.ok){let r=await e.json();throw Error(r.error||"Upload failed")}let r=await e.json();b(r.url)}catch(r){console.error("Upload error:",r);let e=r instanceof Error?r.message:"Unknown error";alert("업로드 실패: ".concat(e))}finally{k(!1)}}}),(0,s.jsx)(d.$,{variant:"outline",onClick:()=>{var e;return null==(e=document.getElementById("file-upload"))?void 0:e.click()},disabled:w,children:"업로드"})]})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"* 3MB 이하의 JPEG, PNG 파일만 업로드 가능합니다."})]}),(0,s.jsx)("div",{className:"bg-muted/50 p-3 rounded-lg text-xs text-muted-foreground",children:(0,s.jsx)("p",{children:"ℹ️ 설정하지 않으면 구글 프로필 정보가 기본으로 적용됩니다."})}),(0,s.jsx)(d.$,{onClick:T,disabled:w,className:"w-full md:w-auto",children:w?"저장 중...":"프로필 저장"})]})]})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold px-1",children:"내 회의 목록"}),E?(0,s.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:"목록을 불러오는 중..."}):0===C.length?(0,s.jsx)(o.Zp,{className:"bg-muted/30 border-dashed",children:(0,s.jsxs)(o.Wu,{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"생성한 회의가 없습니다."}),(0,s.jsx)(d.$,{onClick:()=>v.push("/"),variant:"outline",children:"새 회의 만들기"})]})}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map(e=>(0,s.jsxs)(o.Zp,{className:"hover:shadow-md transition-shadow group",children:[(0,s.jsxs)(o.aR,{className:"pb-3",children:[(0,s.jsxs)(o.ZB,{className:"flex items-center gap-2 text-lg",children:[(0,s.jsx)(m.A,{className:"w-5 h-5 text-primary"}),(0,s.jsx)("span",{className:"truncate",children:e.title})]}),(0,s.jsx)(o.BT,{className:"font-mono text-xs",children:e.id})]}),(0,s.jsx)(o.Wu,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex flex-col gap-2 text-sm text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(f.A,{className:"w-4 h-4"}),(0,h.GP)(new Date(e.createdAt),"yyyy-MM-dd HH:mm")]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.A,{className:"w-4 h-4"}),"참여자 ",e._count.participants,"명 (누적)"]})]})}),(0,s.jsxs)(o.wL,{className:"flex justify-between pt-0",children:[(0,s.jsx)(d.$,{variant:"secondary",size:"sm",onClick:()=>v.push("/meeting/".concat(e.id)),className:"w-full mr-2",children:"입장하기"}),(0,s.jsx)(d.$,{variant:"ghost",size:"icon",onClick:()=>_(e.id),className:"text-muted-foreground hover:text-destructive",children:(0,s.jsx)(p.A,{className:"w-4 h-4"})})]})]},e.id))})]})]})}},1651:(e,r,t)=>{"use strict";t.d(r,{p:()=>i});var s=t(284),a=t(5232),l=t(5250);let i=a.forwardRef((e,r)=>{let{className:t,type:a,...i}=e;return(0,s.jsx)("input",{type:a,className:(0,l.cn)("flex h-12 w-full rounded-md border border-input bg-background px-4 py-3 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...i})});i.displayName="Input"},3327:(e,r,t)=>{"use strict";t.d(r,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>i,aR:()=>n,wL:()=>u});var s=t(284),a=t(5232),l=t(5250);let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});i.displayName="Card";let n=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...a})});n.displayName="CardHeader";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});d.displayName="CardTitle";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,l.cn)("text-sm text-muted-foreground",t),...a})});o.displayName="CardDescription";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,l.cn)("p-6 pt-0",t),...a})});c.displayName="CardContent";let u=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,l.cn)("flex items-center p-6 pt-0",t),...a})});u.displayName="CardFooter"},3971:(e,r,t)=>{Promise.resolve().then(t.bind(t,879))},5250:(e,r,t)=>{"use strict";t.d(r,{cn:()=>l});var s=t(9697),a=t(4673);function l(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.QP)((0,s.$)(r))}},7493:(e,r,t)=>{"use strict";t.d(r,{$:()=>o});var s=t(284),a=t(5232),l=t(2968),i=t(6969),n=t(5250);let d=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,r)=>{let{className:t,variant:a,size:i,asChild:o=!1,...c}=e,u=o?l.DX:"button";return(0,s.jsx)(u,{className:(0,n.cn)(d({variant:a,size:i,className:t})),ref:r,...c})});o.displayName="Button"},8601:(e,r,t)=>{"use strict";t.d(r,{J:()=>o});var s=t(284),a=t(5232),l=t(4972),i=t(6969),n=t(5250);let d=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(l.b,{ref:r,className:(0,n.cn)(d(),t),...a})});o.displayName=l.b.displayName}},e=>{e.O(0,[618,722,149,405,582,30,358],()=>e(e.s=3971)),_N_E=e.O()}]);